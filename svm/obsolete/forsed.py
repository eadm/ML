import numpy as np
import svm.reader
import svm.ml
import svm.kernels
from svm.main import classify

FOLDS = 10
points, classes = svm.reader.read_data("chips.txt")
folds = svm.ml.folds(points, classes, FOLDS, shuffle=True)
EPS = 0.001
sigma = 1.2
C = 2.5

slv = np.array([2.24495348e+00, -2.42567968e-02, 2.52998729e+00, 2.25686599e+00,
                2.24457100e+00, 2.53232095e+00, -5.50937903e-01, 2.53110808e+00,
                3.86955720e+01, 2.87146217e-02, 2.32859025e-01, -2.03898494e-02,
                -2.96496890e-02, 2.53055359e+00, -3.67610080e+00, 2.56782715e-01,
                2.40296234e-01, 2.55023462e+00, 2.24528488e+00, 2.48889176e+00,
                2.26195739e+00, 2.24497969e+00, -2.27705752e-01, 2.53162944e+00,
                2.38107981e+00, 2.53073338e+00, 4.74145164e+01, 2.24528620e+00,
                -2.24892888e-01, 2.53122110e+00, -2.78729288e+01, 2.53115141e+00,
                -2.93727976e-02, -2.80065156e-02, 2.26039470e+00, 2.53161409e+00,
                2.53117724e+00, -5.82136131e-02, 2.53256536e+00, 2.56241225e+00,
                -8.81676711e-02, -7.94654865e-02, 2.24447477e+00, 2.53237381e+00,
                2.24510812e+00, 2.27360498e+00, 2.53104365e+00, 2.53261649e+00,
                2.53123571e+00, -6.00759597e-02, 2.24546716e+00, 2.25664528e+00,
                -8.26729391e-01, 2.53217689e+00, -1.06909410e+00, 2.29441970e+00,
                2.53176501e+00, 2.53247107e+00, 2.53060895e+00, 2.53332998e+00,
                2.53033851e+00, 2.26142692e+00, 2.63884510e-01, 2.26349450e+00,
                -2.30761992e-02, 2.53192492e+00, 2.26880293e+00, 2.59410802e+00,
                -4.17809051e-01, 2.54775115e+00, 2.53165782e+00, 2.24480061e+00,
                5.21785971e+01, 2.39131347e+00, 4.23022907e+00, 2.53220670e+00,
                4.42729213e+00, -3.28561137e-02, 2.53091715e+00, 2.53092769e+00,
                -2.38188587e-02, 2.24546727e+00, 2.53149680e+00, 2.24552542e+00,
                2.24838476e+00, -2.99479116e-02, 2.52081520e+00, 2.48760458e-01,
                2.24912089e+00, 2.24573431e+00, 2.53111702e+00, -8.95890327e-02,
                2.25030461e+00, 2.48487962e-01, 2.26912095e+00, 2.53197587e+00,
                2.26816936e+00, 2.53069454e+00, 2.53277813e+00, 2.53126593e+00,
                2.26546784e+00, 2.53092243e+00, 2.53118997e+00, 2.53161778e+00,
                2.53115399e+00, 2.53261899e+00, 2.43281750e-02])
w = np.array([6.60992317, -7.96319507])
b = 3.96412127856


def get_classes(_points):
    def kernel(x, y):
        return svm.kernels.gaussian(x, y, sigma)

    fold = folds[0]
    ans_c = []
    for p in _points:
        ans_c.append(classify(p, slv, fold["train_p"], fold["train_c"], kernel, C, b, EPS))

    return np.array(ans_c)

